<div class="container mt-5">
  <h2 class="text-center">Tickets de almacenamiento</h2>
  <hr>
  <fn-spinner *ngIf=" loading"></fn-spinner>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Estado</th>
        <th>Fecha</th>
        <th>Responsable</th>
        <th>Acciones</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let ticket of storageTickets;let i = index">
        <td>{{stateSpanishTranslate(ticket.state)}}</td>
        <td>{{ticket.created_at}}</td>
        <td>{{ticket.operator_name == null? "Sin Asignar": ticket.operator_name}}</td>
        <td>
          <div class="dropdown">
            <button type="button" class="btn btn-light" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="bi bi-three-dots-vertical"></i>
            </button>
            <div class="dropdown-content">
              <a data-bs-toggle="modal" data-bs-target="#exampleModal" (click)="showDetails(i)">Detalles</a>
              <button (click)="asignTicket($event)" [value]="ticket.storage_ticket_id"> {{
                getStatusButtonContent(ticket?.state ||
                '')}}</button>
            </div>

          </div>
        </td>

      </tr>
    </tbody>
  </table>
</div>

<!-- Modal -->
<div class="modal fade " id="exampleModal" tabindex="-1" aria-labelledby="detailModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg ">
    <div class="modal-content">
      <div class="modal-header">

        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="">
          <div class="card text-center">
            <div class="card-header">
              Detalles del Ticket {{actualTicket?.storage_ticket_id}}
            </div>
            <div class="card-body">

              <table class="table table-hover table-striped">
                <thead>
                  <tr>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th colspan="3">Ubicacion destino</th>

                  </tr>
                  <tr>
                    <th>Producto</th>
                    <th>Unidad de medida</th>
                    <th>Cantidad</th>
                    <th>Descripcion</th>
                    <th>Zona</th>
                    <th>Section</th>
                    <th>Espacio</th>

                  </tr>
                </thead>

                <tbody>
                  <tr>
                    <td>{{ actualTicket?.product_name }}</td>
                    <td>{{actualTicket?.measure_unit}}</td>
                    <td>{{actualTicket?.quantity}}</td>
                    <td>{{actualTicket?.remarks}}</td>
                    <td>{{actualTicket?.location?.zone}}</td>
                    <td>{{actualTicket?.location?.section}}</td>
                    <td>{{actualTicket?.location?.space}}</td>


                  </tr>
                </tbody>
              </table>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Asign Modal -->
<div class="modal fade" id="asignModal" tabindex="-1" aria-labelledby="asignModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="asignModalLabel">Confirmar</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        Â¿Desea asignarse el ticket?
      </div>
      <div class="modal-footer">
        <button data-bs-dismiss="modal" type="button" class="btn btn-secondary">Cancelar</button>
        <button data-bs-dismiss="modal" type="button" class="btn btn-primary">Aceptar</button>

      </div>
    </div>
  </div>
</div>
<div class="d-flex justify-content-center" style="margin-top: 5%;">
  <ul class="pagination">
    <li class="page-item" style="cursor: pointer;" [class.disabled]="currentPage === 1" (click)="previousPage()">
      <a class="page-link" aria-label="Previous">
        <span aria-hidden="true">&laquo;</span>
      </a>
    </li>
    <li class="page-item">
      <a class="page-link">{{ currentPage }}</a>
    </li>
    <li class="page-item" style="cursor: pointer;" [class.disabled]="currentPage === totalPages" (click)="nextPage()">
      <a class="page-link" aria-label="Next">
        <span aria-hidden="true">&raquo;</span>
      </a>
    </li>
  </ul>
</div>